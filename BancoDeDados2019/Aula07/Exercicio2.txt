CREATE OR REPLACE PACKAGE FINANCEIRO IS
  FUNCTION JUROS(ID_CLIENTE IN CLIENTE.CODCLIENTE%TYPE, PERCENTUAL IN NUMBER) RETURN NUMBER;
  FUNCTION DESCONTO(ID_CLIENTE IN CLIENTE.CODCLIENTE%TYPE,PERCENTUAL IN NUMBER) RETURN NUMBER;
  FUNCTION TOTAL(ID_CLIENTE IN CLIENTE.CODCLIENTE%TYPE) RETURN NUMBER;
END FINANCEIRO;

CREATE OR REPLACE PACKAGE BODY FINANCEIRO IS
  FUNCTION JUROS(ID_CLIENTE IN CLIENTE.CODCLIENTE%TYPE, PERCENTUAL IN NUMBER) RETURN NUMBER IS
    TOTAL NUMBER;
  BEGIN
    SELECT SUM(P.VALORTOTAL) INTO TOTAL FROM PEDIDO P INNER JOIN CLIENTE C ON P.CODCLIENTE = C.CODCLIENTE WHERE C.CODCLIENTE = ID_CLIENTE;
    TOTAL:= TOTAL + (TOTAL * (PERCENTUAL/100));
    RETURN TOTAL;
  END;
  
  FUNCTION DESCONTO(ID_CLIENTE IN CLIENTE.CODCLIENTE%TYPE,PERCENTUAL IN NUMBER) RETURN NUMBER IS
    TOTAL NUMBER;
  BEGIN
    SELECT SUM(P.VALORTOTAL) INTO TOTAL FROM PEDIDO P INNER JOIN CLIENTE C ON P.CODCLIENTE = C.CODCLIENTE WHERE C.CODCLIENTE = ID_CLIENTE;
    TOTAL:= TOTAL - (TOTAL * (PERCENTUAL/100));
    RETURN TOTAL;
  END;
  
  FUNCTION TOTAL(ID_CLIENTE IN CLIENTE.CODCLIENTE%TYPE) RETURN NUMBER IS
    TOTAL NUMBER;
  BEGIN
    SELECT SUM(P.VALORTOTAL)INTO TOTAL FROM PEDIDO P INNER JOIN CLIENTE C ON P.CODCLIENTE = C.CODCLIENTE WHERE C.CODCLIENTE = ID_CLIENTE;
    RETURN TOTAL;
  END;
END FINANCEIRO;

SELECT FINANCEIRO.JUROS(1,10) AS JUROS,FINANCEIRO.DESCONTO(1,10), FINANCEIRO.TOTAL(1) FROM DUAL;


